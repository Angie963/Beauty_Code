<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Beauty Code - Panel Administrador</title>
    <link rel="stylesheet" href="css/style.css">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600&display=swap" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/css/bootstrap.min.css" rel="stylesheet">
</head>

<body class="dashboard-body">
    <header>
        <nav id="menu-admin-s">
            <div>
                <img src="img/logo con delineado.png" class="logo">
            </div>

            <div>
                <a href="dashboard-admin.html">
                    <img src="img/iconos/juego-tablero-alt.png" style="width:20px; padding-right:7px">Dashboard</a>
                <a href="admin-servicios.html">
                    <img src="img/iconos/bolsas-de-compras.png" style="width:22px; padding-right:7px">Servicios</a>
                <a href="admin-galeria.html">
                    <img src="img/iconos/copiar-imagen.png" style="width:23px; padding-right:7px">Galería</a>
                <a href="admin-empleados.html">
                    <img src="img/iconos/empleados-mujer-hombre.png" style="width:23px; padding-right:6px">Empleados</a>
                <a href="admin-disponibilidad.html">
                    <img src="img/iconos/chequeo-de-tiempo.png" style="width:23px; padding-right: 7px;">Disponibilidad</a>
                <a href="admin-citas.html">
                    <img src="img/iconos/dia-del-calendario.png" style="width:21px; padding-right:7px">Citas</a>
            </div>

            <a href="login.html">
                <button class="boton-citas">Cerrar Sesión</button>
            </a>
        </nav>
    </header>

    <main class="admin-container">

        <h1 class="dashboard-title">Gestión de Servicios</h1>
        <p class="dashboard-subtitle">Agrega, edita o elimina servicios del catálogo</p>

        <section class="admin-card">
            <h2>Agregar Nuevo Servicio</h2>

            <form id="serviceForm" class="service-form">

                <div class="fila">
                    <div class="campo">
                <label class="form-label">Nombre del servicio</label>
                <input class="form-control" type="text" id="serviceName" required 
                placeholder="Ej: Manicure con gel" minlength="3">
                    </div>
                    <div class="campo">
                <label class="form-label">Precio</label>
                <input class="form-control" type="text" id="servicePrice" required 
                placeholder="Ej: 45000" minlength="3" pattern="[0-9]+">
                    </div>
                </div>

                <label class="form-label">Descripción</label>
                <textarea id="serviceDesc" required placeholder="Descripción del servicio"></textarea>

                <label class="form-label">Imagen del servicio</label>
                <input class="form-control" type="file" id="serviceImage" accept="image/*">
                <button type="submit" class="btn-primary">Agregar Servicio</button>

            </form>
        </section>

        <div class="admin-card">
            <h2>Servicios Registrados</h2>

            <table class="table">
                <thead>
                    <tr>
                        <th>Imagen</th>
                        <th>Servicio</th>
                        <th>Precio</th>
                        <th>Descripción</th>
                        <th>Acciones</th>
                    </tr>
                </thead>

                <tbody id="serviceList">
                </tbody>
            </table>
        </div>

    </main>

    <script>
// ====== Variables Globales ======
let servicios = JSON.parse(localStorage.getItem("servicios")) || [];
let editIndex = null;

const form = document.getElementById("serviceForm");
const lista = document.getElementById("serviceList");
const nombreInput = document.getElementById("serviceName");
const precioInput = document.getElementById("servicePrice");
const descInput = document.getElementById("serviceDesc");
const imgInput = document.getElementById("serviceImage");

// ====== Renderizar Servicios ======
function cargarServicios() {
    lista.innerHTML = "";

    servicios.forEach((srv, index) => {
        lista.innerHTML += `
            <tr>
                <td><img src="${srv.img}" width="70"></td>
                <td>${srv.nombre}</td>
                <td>$${srv.precio}</td>
                <td>${srv.desc}</td>
                <td>
                    <button class="btn btn-warning btn-sm" onclick="editarServicio(${index})">Editar</button>
                    <button class="btn btn-danger btn-sm" onclick="eliminarServicio(${index})">Eliminar</button>
                </td>
            </tr>
        `;
    });
}

cargarServicios();

// ====== Crear / Editar Servicio ======
form.addEventListener("submit", (e) => {
    e.preventDefault();

    const nombre = nombreInput.value.trim();
    const precio = precioInput.value.trim();
    const desc = descInput.value.trim();
    const file = imgInput.files[0];

    if (!nombre || !precio || !desc) {
        alert("Todos los campos son requeridos");
        return;
    }

    let reader = new FileReader();

    reader.onloadend = () => {
        const servicioData = {
            nombre,
            precio,
            desc,
            img: file ? reader.result : (editIndex !== null ? servicios[editIndex].img : "")
        };

        if (editIndex !== null) {
            servicios[editIndex] = servicioData;
            editIndex = null;
        } else {
            servicios.push(servicioData);
        }

        localStorage.setItem("servicios", JSON.stringify(servicios));
        form.reset();
        cargarServicios();
    };

    if (file) reader.readAsDataURL(file);
    else reader.onloadend();
});

// ====== Eliminar ======
function eliminarServicio(i) {
    servicios.splice(i, 1);
    localStorage.setItem("servicios", JSON.stringify(servicios));
    cargarServicios();
}

// ====== Editar ======
function editarServicio(i) {
    const srv = servicios[i];

    nombreInput.value = srv.nombre;
    precioInput.value = srv.precio;
    descInput.value = srv.desc;

    editIndex = i;
}
</script>

</body>
</html>
